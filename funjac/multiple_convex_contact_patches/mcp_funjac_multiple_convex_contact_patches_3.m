function [F, J, domerr] = mcp_funjac_multiple_convex_contact_patches_3(z, jacflag)

% initialize
z = z(:);
F = [];
J = [];
domerr = 0;

% obtain variable values
global h;

global q_old ;
q_xo = q_old(1);
q_yo = q_old(2);
q_zo = q_old(3);
q0_o = q_old(4);
q1_o = q_old(5);
q2_o = q_old(6);
q3_o = q_old(7);

global nu_old;
v_xo =nu_old(1);
v_yo =nu_old(2);
v_zo =nu_old(3);
w_xo =nu_old(4);
w_yo =nu_old(5);
w_zo =nu_old(6);

global m mu I_xx I_yy I_zz e_o e_r e_t g Height r_s r_b;

global p_x p_y p_z p_xt p_yt p_zt;

% state vector
v_x = z(1);
v_y = z(2);
v_z=  z(3);
w_x = z(4);
w_y = z(5);
w_z = z(6);

a11_x = z(7);
a11_y = z(8);
a11_z = z(9);

a12_x = z(10);
a12_y = z(11);
a12_z = z(12);

a21_x = z(13);
a21_y = z(14);
a21_z = z(15);

a22_x = z(16);
a22_y = z(17);
a22_z = z(18);

a31_x = z(19);
a31_y = z(20);
a31_z = z(21);

a32_x = z(22);
a32_y = z(23);
a32_z = z(24);

p1_t = z(25);
p1_o = z(26);
p1_r = z(27);

p2_t = z(28);
p2_o = z(29);
p2_r = z(30);

p3_t = z(31);
p3_o = z(32);
p3_r = z(33);

sig1 = z(34);
sig2 = z(35);
sig3 = z(36);

l11 = z(37);
l12 = z(38);
l13 = z(39);

l21 = z(40);
l22 = z(41);
l23 = z(42);

l31 = z(43);
l32 = z(44);
l33 = z(45);

p1_n = z(46);
p2_n = z(47);
p3_n = z(48);

% intermediate variables

q0 = -(2*((h*q1_o*w_x)/2 - q0_o + (h*q2_o*w_y)/2 + (h*q3_o*w_z)/2))/(h^2*w_x^2 + h^2*w_y^2 + h^2*w_z^2 + 4)^(1/2);
q1 = (2*(q1_o + (h*q0_o*w_x)/2 + (h*q3_o*w_y)/2 - (h*q2_o*w_z)/2))/(h^2*w_x^2 + h^2*w_y^2 + h^2*w_z^2 + 4)^(1/2);
q2 = (2*(q2_o - (h*q3_o*w_x)/2 + (h*q0_o*w_y)/2 + (h*q1_o*w_z)/2))/(h^2*w_x^2 + h^2*w_y^2 + h^2*w_z^2 + 4)^(1/2);
q3 = (2*(q3_o + (h*q2_o*w_x)/2 - (h*q1_o*w_y)/2 + (h*q0_o*w_z)/2))/(h^2*w_x^2 + h^2*w_y^2 + h^2*w_z^2 + 4)^(1/2);

q_x = q_xo+h*v_x;
q_y = q_yo+h*v_y;
q_z = q_zo+h*v_z;

R11 = q0^2 + q1^2 - q2^2 - q3^2;
R12 = 2*q1*q2 - 2*q0*q3;
R13 = 2*q0*q2 + 2*q1*q3;
R21 = 2*q0*q3 + 2*q1*q2;
R22 = q0^2 - q1^2 + q2^2 - q3^2;
R23 = 2*q2*q3 - 2*q0*q1;
R31 = 2*q1*q3 - 2*q0*q2;
R32 = 2*q0*q1 + 2*q2*q3;
R33 = q0^2 - q1^2 - q2^2 + q3^2;

% simplifaction variables
r1_x = R11*a11_x + R21*a11_y + R31*a11_z - R11*q_x - R21*q_y - R31*q_z;
r1_y = R12*a11_x + R22*a11_y + R32*a11_z - R12*q_x - R22*q_y - R32*q_z;
r2_x = R11*a21_x + R21*a21_y + R31*a21_z - R11*q_x - R21*q_y - R31*q_z;
r2_y = R12*a21_x + R22*a21_y + R32*a21_z - R12*q_x - R22*q_y - R32*q_z;
r3_x = R11*a31_x + R21*a31_y + R31*a31_z - R11*q_x - R21*q_y - R31*q_z;
r3_y = R12*a31_x + R22*a31_y + R32*a31_z - R12*q_x - R22*q_y - R32*q_z;



p_a1zt = p1_o*(a11_x - q_x) - p1_t*(a11_y - q_y);
p_a2zt = p2_o*(a21_x - q_x) - p2_t*(a21_y - q_y);
p_a3zt = p3_o*(a31_x - q_x) - p3_t*(a31_y - q_y);

I11 = (I_xx*R11^2 + I_yy*R12^2 + I_zz*R13^2);
I12 = (I_xx*R11*R21 + I_yy*R12*R22 + I_zz*R13*R23);
I13 = (I_xx*R11*R31 + I_yy*R12*R32 + I_zz*R13*R33);
%I21 = I12;
I22 = (I_xx*R21^2 + I_yy*R22^2 + I_zz*R23^2);
I23 = (I_xx*R21*R31 + I_yy*R22*R32 + I_zz*R23*R33);
%I31 = I13;
%I32 = I23;
I33 = (I_xx*R31^2 + I_yy*R32^2 + I_zz*R33^2);
w_s = (h^2*w_x^2 + h^2*w_y^2 + h^2*w_z^2 + 4)^(3/2);

a_x = (p1_n*(a11_x - q_x) + p2_n*(a21_x - q_x) + p3_n*(a31_x - q_x))/(p1_n + p2_n + p3_n) + q_x;
a_y = (p1_n*(a11_y - q_y) + p2_n*(a21_y - q_y) + p3_n*(a31_y - q_y))/(p1_n + p2_n + p3_n) + q_y;
a_z = (p1_n*(a11_z - q_z) + p2_n*(a21_z - q_z) + p3_n*(a31_z - q_z))/(p1_n + p2_n + p3_n) + q_z;

p_rE1 = p1_r + p1_o*(a11_x - a_x) - p1_t*(a11_y - a_y);
p_rE2 = p2_r + p2_o*(a21_x - a_x) - p2_t*(a21_y - a_y);
p_rE3 = p3_r + p3_o*(a31_x - a_x) - p3_t*(a31_y - a_y);

p_n = p1_n + p2_n + p3_n;
%%
F(1) = p1_t + p2_t + p3_t + p_x - m*(v_x - v_xo);
F(2) = p1_o + p2_o + p3_o + p_y - m*(v_y - v_yo);
F(3) = p1_n + p2_n + p3_n + p_z - m*(v_z - v_zo) - g*h*m;

F(4) = p_xt + p1_n*(a11_y - q_y) + p2_n*(a21_y - q_y) + p3_n*(a31_y - q_y) - p1_o*(a11_z - q_z) - p2_o*(a21_z - q_z) - p3_o*(a31_z - q_z) - h*(w_yo*(I13*w_xo + I23*w_yo + I33*w_zo) - w_zo*(I12*w_xo + I22*w_yo + I23*w_zo)) - I11*(w_x - w_xo) - I12*(w_y - w_yo) - I13*(w_z - w_zo);
F(5) = p_yt - p1_n*(a11_x - q_x) - p2_n*(a21_x - q_x) - p3_n*(a31_x - q_x) + p1_t*(a11_z - q_z) + p2_t*(a21_z - q_z) + p3_t*(a31_z - q_z) + h*(w_xo*(I13*w_xo + I23*w_yo + I33*w_zo) - w_zo*(I11*w_xo + I12*w_yo + I13*w_zo)) - I12*(w_x - w_xo) - I22*(w_y - w_yo) - I23*(w_z - w_zo);
F(6) = p1_r + p2_r + p3_r + p_a1zt + p_a2zt + p_a3zt + p_zt  - h*(w_xo*(I12*w_xo + I22*w_yo + I23*w_zo) - w_yo*(I11*w_xo + I12*w_yo + I13*w_zo)) - I13*(w_x - w_xo) - I23*(w_y - w_yo) - I33*(w_z - w_zo);

F(7) = p1_t*sig1 + e_t^2*mu*p1_n*v_x - e_t^2*mu*p1_n*w_z*(a_y - q_y) + e_t^2*mu*p1_n*w_y*(a_z - q_z);
F(8) = p1_o*sig1 + e_o^2*mu*p1_n*v_y + e_o^2*mu*p1_n*w_z*(a_x - q_x) - e_o^2*mu*p1_n*w_x*(a_z - q_z);
F(9) = mu*p1_n*w_z*e_r^2 + p_rE1*sig1;

F(10) = p2_t*sig2 + e_t^2*mu*p2_n*v_x - e_t^2*mu*p2_n*w_z*(a_y - q_y) + e_t^2*mu*p2_n*w_y*(a_z - q_z);
F(11) = p2_o*sig2 + e_o^2*mu*p2_n*v_y + e_o^2*mu*p2_n*w_z*(a_x - q_x) - e_o^2*mu*p2_n*w_x*(a_z - q_z);
F(12) = mu*p2_n*w_z*e_r^2 + p_rE2*sig2;

F(13) = p3_t*sig3 + e_t^2*mu*p3_n*v_x - e_t^2*mu*p3_n*w_z*(a_y - q_y) + e_t^2*mu*p3_n*w_y*(a_z - q_z);
F(14) = p3_o*sig3 + e_o^2*mu*p3_n*v_y + e_o^2*mu*p3_n*w_z*(a_x - q_x) - e_o^2*mu*p3_n*w_x*(a_z - q_z);
F(15) = mu*p3_n*w_z*e_r^2 + p_rE3*sig3;

F(16) = a12_x - a11_x;
F(17) = a12_y - a11_y;
F(18) = a12_z - a11_z + l13;

F(19) = l12*(2*R12*(r1_y + r_b/2) + 2*R11*(r1_x + (3^(1/2)*r_b)/2)) - R13*l11;
F(20) = l12*(2*R22*(r1_y + r_b/2) + 2*R21*(r1_x + (3^(1/2)*r_b)/2)) - R23*l11;
F(21) = l12*(2*R32*(r1_y + r_b/2) + 2*R31*(r1_x + (3^(1/2)*r_b)/2)) - R33*l11 + 1;

F(22) = a22_x - a21_x;
F(23) = a22_y - a21_y;
F(24) = a22_z - a21_z + l23;

F(25) = l22*(2*R12*(r2_y + r_b/2) + 2*R11*(r2_x - (3^(1/2)*r_b)/2)) - R13*l21;
F(26) = l22*(2*R22*(r2_y + r_b/2) + 2*R21*(r2_x - (3^(1/2)*r_b)/2)) - R23*l21;
F(27) = l22*(2*R32*(r2_y + r_b/2) + 2*R31*(r2_x - (3^(1/2)*r_b)/2)) - R33*l21 + 1;

F(28) = a32_x - a31_x;
F(29) = a32_y - a31_y;
F(30) = a32_z - a31_z + l33;

F(31) = l32*(2*R11*r3_x + 2*R12*(r3_y - r_b)) - R13*l31;
F(32) = l32*(2*R21*r3_x + 2*R22*(r3_y - r_b)) - R23*l31;
F(33) = l32*(2*R31*r3_x + 2*R32*(r3_y - r_b)) - R33*l31 + 1;

F(34) = mu^2*p1_n^2 - p_rE1^2/e_r^2 - p1_t^2/e_t^2 - p1_o^2/e_o^2;
F(35) = mu^2*p2_n^2 - p_rE2^2/e_r^2 - p2_t^2/e_t^2 - p2_o^2/e_o^2;
F(36) = mu^2*p3_n^2 - p_rE3^2/e_r^2 - p3_t^2/e_t^2 - p3_o^2/e_o^2;

F(37) = Height + R13*a11_x + R23*a11_y + R33*a11_z - R13*q_x - R23*q_y - R33*q_z;
F(38) = r_s^2 - (r1_x + (3^(1/2)*r_b)/2)^2 - (r1_y + r_b/2)^2;
F(39) = -a12_z;

F(40) = Height + R13*a21_x + R23*a21_y + R33*a21_z - R13*q_x - R23*q_y - R33*q_z;
F(41) = r_s^2 - (r2_x - (3^(1/2)*r_b)/2)^2 - (r2_y + r_b/2)^2;
F(42) = -a22_z;

F(43) = Height + R13*a31_x + R23*a31_y + R33*a31_z - R13*q_x - R23*q_y - R33*q_z;
F(44) = r_s^2 - r3_x^2 - (r3_y - r_b)^2;
F(45) = -a32_z;  

F(46) = a11_z;
F(47) = a21_z;
F(48) = a31_z;  


if (jacflag)
         J1 = [            -m,             0,  0,                                            0,                                            0,                                            0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                   0,                                    0,                                 0, 0, 0,  0,                                              1,                                                0,                0,                                              1,                                                0,                0,                                              1,                                                0,                0,     0,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                     0,                                                     0,                                                     0
                            0,            -m,  0,                                            0,                                            0,                                            0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                   0,                                    0,                                 0, 0, 0,  0,                                              0,                                                1,                0,                                              0,                                                1,                0,                                              0,                                                1,                0,     0,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                     0,                                                     0,                                                     0
                            0,             0, -m,                                            0,                                            0,                                            0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                   0,                                    0,                                 0, 0, 0,  0,                                              0,                                                0,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,     0,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                                                                                1,                                                                                                                                                1,                                                                                                                                                1,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                     0,                                                     0,                                                     0
                            0,             0,  0,       - I_xx*R11^2 - I_yy*R12^2 - I_zz*R13^2, - I_xx*R11*R21 - I_yy*R12*R22 - I_zz*R13*R23, - I_xx*R11*R31 - I_yy*R12*R32 - I_zz*R13*R33,                                                       0,                                                    p1_n,                                                   -p1_o, 0, 0,  0,                                                       0,                                                    p2_n,                                                   -p2_o, 0, 0,  0,                                   0,                                 p3_n,                             -p3_o, 0, 0,  0,                                              0,                                      q_z - a11_z,                0,                                              0,                                      q_z - a21_z,                0,                                              0,                                      q_z - a31_z,                0,     0,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                                                                      a11_y - q_y,                                                                                                                                      a21_y - q_y,                                                                                                                                      a31_y - q_y, - h*(I_xx*R31*w_xo*w_yo - I_xx*R21*w_xo*w_zo) - 2*I_xx*R11*(w_x - w_xo) - I_xx*R21*(w_y - w_yo) - I_xx*R31*(w_z - w_zo), - h*(I_yy*R32*w_xo*w_yo - I_yy*R22*w_xo*w_zo) - 2*I_yy*R12*(w_x - w_xo) - I_yy*R22*(w_y - w_yo) - I_yy*R32*(w_z - w_zo), - h*(I_zz*R33*w_xo*w_yo - I_zz*R23*w_xo*w_zo) - 2*I_zz*R13*(w_x - w_xo) - I_zz*R23*(w_y - w_yo) - I_zz*R33*(w_z - w_zo),                  h*(w_zo*(I_xx*R11*w_xo + 2*I_xx*R21*w_yo + I_xx*R31*w_zo) - I_xx*R31*w_yo^2) - I_xx*R11*(w_y - w_yo),                  h*(w_zo*(I_yy*R12*w_xo + 2*I_yy*R22*w_yo + I_yy*R32*w_zo) - I_yy*R32*w_yo^2) - I_yy*R12*(w_y - w_yo),                  h*(w_zo*(I_zz*R13*w_xo + 2*I_zz*R23*w_yo + I_zz*R33*w_zo) - I_zz*R33*w_yo^2) - I_zz*R13*(w_y - w_yo),                  - h*(w_yo*(I_xx*R11*w_xo + I_xx*R21*w_yo + 2*I_xx*R31*w_zo) - I_xx*R21*w_zo^2) - I_xx*R11*(w_z - w_zo),                  - h*(w_yo*(I_yy*R12*w_xo + I_yy*R22*w_yo + 2*I_yy*R32*w_zo) - I_yy*R22*w_zo^2) - I_yy*R12*(w_z - w_zo),                  - h*(w_yo*(I_zz*R13*w_xo + I_zz*R23*w_yo + 2*I_zz*R33*w_zo) - I_zz*R23*w_zo^2) - I_zz*R13*(w_z - w_zo),                                                     0,                                                  -p_n,                                    p1_o + p2_o + p3_o
                            0,             0,  0, - I_xx*R11*R21 - I_yy*R12*R22 - I_zz*R13*R23,       - I_xx*R21^2 - I_yy*R22^2 - I_zz*R23^2, - I_xx*R21*R31 - I_yy*R22*R32 - I_zz*R23*R33,                                                   -p1_n,                                                       0,                                                    p1_t, 0, 0,  0,                                                   -p2_n,                                                       0,                                                    p2_t, 0, 0,  0,                               -p3_n,                                    0,                              p3_t, 0, 0,  0,                                    a11_z - q_z,                                                0,                0,                                    a21_z - q_z,                                                0,                0,                                    a31_z - q_z,                                                0,                0,     0,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                                                                      q_x - a11_x,                                                                                                                                      q_x - a21_x,                                                                                                                                      q_x - a31_x,                  - h*(w_zo*(2*I_xx*R11*w_xo + I_xx*R21*w_yo + I_xx*R31*w_zo) - I_xx*R31*w_xo^2) - I_xx*R21*(w_x - w_xo),                  - h*(w_zo*(2*I_yy*R12*w_xo + I_yy*R22*w_yo + I_yy*R32*w_zo) - I_yy*R32*w_xo^2) - I_yy*R22*(w_x - w_xo),                  - h*(w_zo*(2*I_zz*R13*w_xo + I_zz*R23*w_yo + I_zz*R33*w_zo) - I_zz*R33*w_xo^2) - I_zz*R23*(w_x - w_xo), h*(I_xx*R31*w_xo*w_yo - I_xx*R11*w_yo*w_zo) - I_xx*R11*(w_x - w_xo) - 2*I_xx*R21*(w_y - w_yo) - I_xx*R31*(w_z - w_zo), h*(I_yy*R32*w_xo*w_yo - I_yy*R12*w_yo*w_zo) - I_yy*R12*(w_x - w_xo) - 2*I_yy*R22*(w_y - w_yo) - I_yy*R32*(w_z - w_zo), h*(I_zz*R33*w_xo*w_yo - I_zz*R13*w_yo*w_zo) - I_zz*R13*(w_x - w_xo) - 2*I_zz*R23*(w_y - w_yo) - I_zz*R33*(w_z - w_zo),                    h*(w_xo*(I_xx*R11*w_xo + I_xx*R21*w_yo + 2*I_xx*R31*w_zo) - I_xx*R11*w_zo^2) - I_xx*R21*(w_z - w_zo),                    h*(w_xo*(I_yy*R12*w_xo + I_yy*R22*w_yo + 2*I_yy*R32*w_zo) - I_yy*R12*w_zo^2) - I_yy*R22*(w_z - w_zo),                    h*(w_xo*(I_zz*R13*w_xo + I_zz*R23*w_yo + 2*I_zz*R33*w_zo) - I_zz*R13*w_zo^2) - I_zz*R23*(w_z - w_zo),                                                   p_n,                                                     0,                                  - p1_t - p2_t - p3_t
                            0,             0,  0, - I_xx*R11*R31 - I_yy*R12*R32 - I_zz*R13*R33, - I_xx*R21*R31 - I_yy*R22*R32 - I_zz*R23*R33,       - I_xx*R31^2 - I_yy*R32^2 - I_zz*R33^2,                                                    p1_o,                                                   -p1_t,                                                       0, 0, 0,  0,                                                    p2_o,                                                   -p2_t,                                                       0, 0, 0,  0,                                p3_o,                                -p3_t,                                 0, 0, 0,  0,                                    q_y - a11_y,                                      a11_x - q_x,                1,                                    q_y - a21_y,                                      a21_x - q_x,                1,                                    q_y - a31_y,                                      a31_x - q_x,                1,     0,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                    h*(w_yo*(2*I_xx*R11*w_xo + I_xx*R21*w_yo + I_xx*R31*w_zo) - I_xx*R21*w_xo^2) - I_xx*R31*(w_x - w_xo),                    h*(w_yo*(2*I_yy*R12*w_xo + I_yy*R22*w_yo + I_yy*R32*w_zo) - I_yy*R22*w_xo^2) - I_yy*R32*(w_x - w_xo),                    h*(w_yo*(2*I_zz*R13*w_xo + I_zz*R23*w_yo + I_zz*R33*w_zo) - I_zz*R23*w_xo^2) - I_zz*R33*(w_x - w_xo),                - h*(w_xo*(I_xx*R11*w_xo + 2*I_xx*R21*w_yo + I_xx*R31*w_zo) - I_xx*R11*w_yo^2) - I_xx*R31*(w_y - w_yo),                - h*(w_xo*(I_yy*R12*w_xo + 2*I_yy*R22*w_yo + I_yy*R32*w_zo) - I_yy*R12*w_yo^2) - I_yy*R32*(w_y - w_yo),                - h*(w_xo*(I_zz*R13*w_xo + 2*I_zz*R23*w_yo + I_zz*R33*w_zo) - I_zz*R13*w_yo^2) - I_zz*R33*(w_y - w_yo), - h*(I_xx*R21*w_xo*w_zo - I_xx*R11*w_yo*w_zo) - I_xx*R11*(w_x - w_xo) - I_xx*R21*(w_y - w_yo) - 2*I_xx*R31*(w_z - w_zo), - h*(I_yy*R22*w_xo*w_zo - I_yy*R12*w_yo*w_zo) - I_yy*R12*(w_x - w_xo) - I_yy*R22*(w_y - w_yo) - 2*I_yy*R32*(w_z - w_zo), - h*(I_zz*R23*w_xo*w_zo - I_zz*R13*w_yo*w_zo) - I_zz*R13*(w_x - w_xo) - I_zz*R23*(w_y - w_yo) - 2*I_zz*R33*(w_z - w_zo),                                  - p1_o - p2_o - p3_o,                                    p1_t + p2_t + p3_t,                                                     0
                e_t^2*mu*p1_n,             0,  0,                                            0,                    e_t^2*mu*p1_n*(a_z - q_z),                   -e_t^2*mu*p1_n*(a_y - q_y),                                                       0,                              -(e_t^2*mu*p1_n^2*w_z)/p_n,                               (e_t^2*mu*p1_n^2*w_y)/p_n, 0, 0,  0,                                                       0,                           -(e_t^2*mu*p1_n*p2_n*w_z)/p_n,                            (e_t^2*mu*p1_n*p2_n*w_y)/p_n, 0, 0,  0,                                   0,        -(e_t^2*mu*p1_n*p3_n*w_z)/p_n,      (e_t^2*mu*p1_n*p3_n*w_y)/p_n, 0, 0,  0,                                           sig1,                                                0,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,  p1_t,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0, (e_t^2*mu*(p_n*v_x + a11_z*p1_n*w_y - a11_y*p1_n*w_z + a_y*p1_n*w_z - a_z*p1_n*w_y - a_y*p_n*w_z + a_z*p_n*w_y + p_n*q_y*w_z - p_n*q_z*w_y))/p_n,                                                                                  (e_t^2*mu*p1_n*(a21_z*w_y - a21_y*w_z + a_y*w_z - a_z*w_y))/p_n,                                                                                  (e_t^2*mu*p1_n*(a31_z*w_y - a31_y*w_z + a_y*w_z - a_z*w_y))/p_n,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                     0,                                     e_t^2*mu*p1_n*w_z,                                    -e_t^2*mu*p1_n*w_y
                            0, e_o^2*mu*p1_n,  0,                   -e_o^2*mu*p1_n*(a_z - q_z),                                            0,                    e_o^2*mu*p1_n*(a_x - q_x),                               (e_o^2*mu*p1_n^2*w_z)/p_n,                                                       0,                              -(e_o^2*mu*p1_n^2*w_x)/p_n, 0, 0,  0,                            (e_o^2*mu*p1_n*p2_n*w_z)/p_n,                                                       0,                           -(e_o^2*mu*p1_n*p2_n*w_x)/p_n, 0, 0,  0,        (e_o^2*mu*p1_n*p3_n*w_z)/p_n,                                    0,     -(e_o^2*mu*p1_n*p3_n*w_x)/p_n, 0, 0,  0,                                              0,                                             sig1,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,  p1_o,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0, (e_o^2*mu*(p_n*v_y - a11_z*p1_n*w_x + a11_x*p1_n*w_z - a_x*p1_n*w_z + a_z*p1_n*w_x + a_x*p_n*w_z - a_z*p_n*w_x - p_n*q_x*w_z + p_n*q_z*w_x))/p_n,                                                                                 -(e_o^2*mu*p1_n*(a21_z*w_x - a21_x*w_z + a_x*w_z - a_z*w_x))/p_n,                                                                                 -(e_o^2*mu*p1_n*(a31_z*w_x - a31_x*w_z + a_x*w_z - a_z*w_x))/p_n,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                    -e_o^2*mu*p1_n*w_z,                                                     0,                                     e_o^2*mu*p1_n*w_x
                            0,             0,  0,                                            0,                                            0,                                e_r^2*mu*p1_n,                               -p1_o*sig1*(p1_n/p_n - 1),                                p1_t*sig1*(p1_n/p_n - 1),                                                       0, 0, 0,  0,                                   -(p1_o*p2_n*sig1)/p_n,                                    (p2_n*p1_t*sig1)/p_n,                                                       0, 0, 0,  0,               -(p1_o*p3_n*sig1)/p_n,                 (p3_n*p1_t*sig1)/p_n,                                 0, 0, 0,  0,                            -sig1*(a11_y - a_y),                               sig1*(a11_x - a_x),             sig1,                                              0,                                                0,                0,                                              0,                                                0,                0, p_rE1,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                       (mu*p_n*w_z*e_r^2 - a11_x*p1_o*sig1 + a11_y*p1_t*sig1 + a_x*p1_o*sig1 - a_y*p1_t*sig1)/p_n,                                                                                      -(sig1*(a21_x*p1_o - a21_y*p1_t - a_x*p1_o + a_y*p1_t))/p_n,                                                                                      -(sig1*(a31_x*p1_o - a31_y*p1_t - a_x*p1_o + a_y*p1_t))/p_n,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                     0,                                                     0,                                                     0
                e_t^2*mu*p2_n,             0,  0,                                            0,                    e_t^2*mu*p2_n*(a_z - q_z),                   -e_t^2*mu*p2_n*(a_y - q_y),                                                       0,                           -(e_t^2*mu*p1_n*p2_n*w_z)/p_n,                            (e_t^2*mu*p1_n*p2_n*w_y)/p_n, 0, 0,  0,                                                       0,                              -(e_t^2*mu*p2_n^2*w_z)/p_n,                               (e_t^2*mu*p2_n^2*w_y)/p_n, 0, 0,  0,                                   0,        -(e_t^2*mu*p2_n*p3_n*w_z)/p_n,      (e_t^2*mu*p2_n*p3_n*w_y)/p_n, 0, 0,  0,                                              0,                                                0,                0,                                           sig2,                                                0,                0,                                              0,                                                0,                0,     0,  p2_t,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                  (e_t^2*mu*p2_n*(a11_z*w_y - a11_y*w_z + a_y*w_z - a_z*w_y))/p_n, (e_t^2*mu*(p_n*v_x + a21_z*p2_n*w_y - a21_y*p2_n*w_z + a_y*p2_n*w_z - a_z*p2_n*w_y - a_y*p_n*w_z + a_z*p_n*w_y + p_n*q_y*w_z - p_n*q_z*w_y))/p_n,                                                                                  (e_t^2*mu*p2_n*(a31_z*w_y - a31_y*w_z + a_y*w_z - a_z*w_y))/p_n,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                     0,                                     e_t^2*mu*p2_n*w_z,                                    -e_t^2*mu*p2_n*w_y
                            0, e_o^2*mu*p2_n,  0,                   -e_o^2*mu*p2_n*(a_z - q_z),                                            0,                    e_o^2*mu*p2_n*(a_x - q_x),                            (e_o^2*mu*p1_n*p2_n*w_z)/p_n,                                                       0,                           -(e_o^2*mu*p1_n*p2_n*w_x)/p_n, 0, 0,  0,                               (e_o^2*mu*p2_n^2*w_z)/p_n,                                                       0,                              -(e_o^2*mu*p2_n^2*w_x)/p_n, 0, 0,  0,        (e_o^2*mu*p2_n*p3_n*w_z)/p_n,                                    0,     -(e_o^2*mu*p2_n*p3_n*w_x)/p_n, 0, 0,  0,                                              0,                                                0,                0,                                              0,                                             sig2,                0,                                              0,                                                0,                0,     0,  p2_o,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                 -(e_o^2*mu*p2_n*(a11_z*w_x - a11_x*w_z + a_x*w_z - a_z*w_x))/p_n, (e_o^2*mu*(p_n*v_y - a21_z*p2_n*w_x + a21_x*p2_n*w_z - a_x*p2_n*w_z + a_z*p2_n*w_x + a_x*p_n*w_z - a_z*p_n*w_x - p_n*q_x*w_z + p_n*q_z*w_x))/p_n,                                                                                 -(e_o^2*mu*p2_n*(a31_z*w_x - a31_x*w_z + a_x*w_z - a_z*w_x))/p_n,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                    -e_o^2*mu*p2_n*w_z,                                                     0,                                     e_o^2*mu*p2_n*w_x
                            0,             0,  0,                                            0,                                            0,                                e_r^2*mu*p2_n,                                   -(p1_n*p2_o*sig2)/p_n,                                    (p1_n*p2_t*sig2)/p_n,                                                       0, 0, 0,  0,                               -p2_o*sig2*(p2_n/p_n - 1),                                p2_t*sig2*(p2_n/p_n - 1),                                                       0, 0, 0,  0,               -(p2_o*p3_n*sig2)/p_n,                 (p3_n*p2_t*sig2)/p_n,                                 0, 0, 0,  0,                                              0,                                                0,                0,                            -sig2*(a21_y - a_y),                               sig2*(a21_x - a_x),             sig2,                                              0,                                                0,                0,     0, p_rE2,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                      -(sig2*(a11_x*p2_o - a11_y*p2_t - a_x*p2_o + a_y*p2_t))/p_n,                                                       (mu*p_n*w_z*e_r^2 - a21_x*p2_o*sig2 + a21_y*p2_t*sig2 + a_x*p2_o*sig2 - a_y*p2_t*sig2)/p_n,                                                                                      -(sig2*(a31_x*p2_o - a31_y*p2_t - a_x*p2_o + a_y*p2_t))/p_n,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                     0,                                                     0,                                                     0
                e_t^2*mu*p3_n,             0,  0,                                            0,                    e_t^2*mu*p3_n*(a_z - q_z),                   -e_t^2*mu*p3_n*(a_y - q_y),                                                       0,                           -(e_t^2*mu*p1_n*p3_n*w_z)/p_n,                            (e_t^2*mu*p1_n*p3_n*w_y)/p_n, 0, 0,  0,                                                       0,                           -(e_t^2*mu*p2_n*p3_n*w_z)/p_n,                            (e_t^2*mu*p2_n*p3_n*w_y)/p_n, 0, 0,  0,                                   0,           -(e_t^2*mu*p3_n^2*w_z)/p_n,         (e_t^2*mu*p3_n^2*w_y)/p_n, 0, 0,  0,                                              0,                                                0,                0,                                              0,                                                0,                0,                                           sig3,                                                0,                0,     0,     0,  p3_t,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                  (e_t^2*mu*p3_n*(a11_z*w_y - a11_y*w_z + a_y*w_z - a_z*w_y))/p_n,                                                                                  (e_t^2*mu*p3_n*(a21_z*w_y - a21_y*w_z + a_y*w_z - a_z*w_y))/p_n, (e_t^2*mu*(p_n*v_x + a31_z*p3_n*w_y - a31_y*p3_n*w_z + a_y*p3_n*w_z - a_z*p3_n*w_y - a_y*p_n*w_z + a_z*p_n*w_y + p_n*q_y*w_z - p_n*q_z*w_y))/p_n,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                     0,                                     e_t^2*mu*p3_n*w_z,                                    -e_t^2*mu*p3_n*w_y
                            0, e_o^2*mu*p3_n,  0,                   -e_o^2*mu*p3_n*(a_z - q_z),                                            0,                    e_o^2*mu*p3_n*(a_x - q_x),                            (e_o^2*mu*p1_n*p3_n*w_z)/p_n,                                                       0,                           -(e_o^2*mu*p1_n*p3_n*w_x)/p_n, 0, 0,  0,                            (e_o^2*mu*p2_n*p3_n*w_z)/p_n,                                                       0,                           -(e_o^2*mu*p2_n*p3_n*w_x)/p_n, 0, 0,  0,           (e_o^2*mu*p3_n^2*w_z)/p_n,                                    0,        -(e_o^2*mu*p3_n^2*w_x)/p_n, 0, 0,  0,                                              0,                                                0,                0,                                              0,                                                0,                0,                                              0,                                             sig3,                0,     0,     0,  p3_o,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                 -(e_o^2*mu*p3_n*(a11_z*w_x - a11_x*w_z + a_x*w_z - a_z*w_x))/p_n,                                                                                 -(e_o^2*mu*p3_n*(a21_z*w_x - a21_x*w_z + a_x*w_z - a_z*w_x))/p_n, (e_o^2*mu*(p_n*v_y - a31_z*p3_n*w_x + a31_x*p3_n*w_z - a_x*p3_n*w_z + a_z*p3_n*w_x + a_x*p_n*w_z - a_z*p_n*w_x - p_n*q_x*w_z + p_n*q_z*w_x))/p_n,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                    -e_o^2*mu*p3_n*w_z,                                                     0,                                     e_o^2*mu*p3_n*w_x
                            0,             0,  0,                                            0,                                            0,                                e_r^2*mu*p3_n,                                   -(p1_n*p3_o*sig3)/p_n,                                    (p1_n*p3_t*sig3)/p_n,                                                       0, 0, 0,  0,                                   -(p2_n*p3_o*sig3)/p_n,                                    (p2_n*p3_t*sig3)/p_n,                                                       0, 0, 0,  0,           -p3_o*sig3*(p3_n/p_n - 1),             p3_t*sig3*(p3_n/p_n - 1),                                 0, 0, 0,  0,                                              0,                                                0,                0,                                              0,                                                0,                0,                            -sig3*(a31_y - a_y),                               sig3*(a31_x - a_x),             sig3,     0,     0, p_rE3,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                      -(sig3*(a11_x*p3_o - a11_y*p3_t - a_x*p3_o + a_y*p3_t))/p_n,                                                                                      -(sig3*(a21_x*p3_o - a21_y*p3_t - a_x*p3_o + a_y*p3_t))/p_n,                                                       (mu*p_n*w_z*e_r^2 - a31_x*p3_o*sig3 + a31_y*p3_t*sig3 + a_x*p3_o*sig3 - a_y*p3_t*sig3)/p_n,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                     0,                                                     0,                                                     0
                            0,             0,  0,                                            0,                                            0,                                            0,                                                      -1,                                                       0,                                                       0, 1, 0,  0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                   0,                                    0,                                 0, 0, 0,  0,                                              0,                                                0,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,     0,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                     0,                                                     0,                                                     0
                            0,             0,  0,                                            0,                                            0,                                            0,                                                       0,                                                      -1,                                                       0, 0, 1,  0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                   0,                                    0,                                 0, 0, 0,  0,                                              0,                                                0,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,     0,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                     0,                                                     0,                                                     0
                            0,             0,  0,                                            0,                                            0,                                            0,                                                       0,                                                       0,                                                      -1, 0, 0,  1,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                   0,                                    0,                                 0, 0, 0,  0,                                              0,                                                0,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,     0,     0,     0,    0,                                                     0, 1,    0,                                                     0, 0,    0,                               0, 0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                     0,                                                     0,                                                     0
                            0,             0,  0,                                            0,                                            0,                                            0,                                 l12*(2*R11^2 + 2*R12^2),                             l12*(2*R11*R21 + 2*R12*R22),                             l12*(2*R11*R31 + 2*R12*R32), 0, 0,  0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                   0,                                    0,                                 0, 0, 0,  0,                                              0,                                                0,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,     0,     0,     0, -R13, 2*R12*(r1_y + r_b/2) + 2*R11*(r1_x + (3^(1/2)*r_b)/2), 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                                                                        l12*(2*r1_x + 3^(1/2)*r_b + 2*R11*(a11_x - q_x)),                                                                                l12*(2*r1_y + r_b + 2*R12*(a11_x - q_x)),                                                                                                                    -l11,                                                                                               2*R11*l12*(a11_y - q_y),                                                                                               2*R12*l12*(a11_y - q_y),                                                                                                                     0,                                                                                                 2*R11*l12*(a11_z - q_z),                                                                                                 2*R12*l12*(a11_z - q_z),                                                                                                                       0,                              -l12*(2*R11^2 + 2*R12^2),                          -l12*(2*R11*R21 + 2*R12*R22),                          -l12*(2*R11*R31 + 2*R12*R32)
                            0,             0,  0,                                            0,                                            0,                                            0,                             l12*(2*R11*R21 + 2*R12*R22),                                 l12*(2*R21^2 + 2*R22^2),                             l12*(2*R21*R31 + 2*R22*R32), 0, 0,  0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                   0,                                    0,                                 0, 0, 0,  0,                                              0,                                                0,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,     0,     0,     0, -R23, 2*R22*(r1_y + r_b/2) + 2*R21*(r1_x + (3^(1/2)*r_b)/2), 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                 2*R21*l12*(a11_x - q_x),                                                                                                 2*R22*l12*(a11_x - q_x),                                                                                                                       0,                                                                      l12*(2*r1_x + 3^(1/2)*r_b + 2*R21*(a11_y - q_y)),                                                                              l12*(2*r1_y + r_b + 2*R22*(a11_y - q_y)),                                                                                                                  -l11,                                                                                                 2*R21*l12*(a11_z - q_z),                                                                                                 2*R22*l12*(a11_z - q_z),                                                                                                                       0,                          -l12*(2*R11*R21 + 2*R12*R22),                              -l12*(2*R21^2 + 2*R22^2),                          -l12*(2*R21*R31 + 2*R22*R32)
                            0,             0,  0,                                            0,                                            0,                                            0,                             l12*(2*R11*R31 + 2*R12*R32),                             l12*(2*R21*R31 + 2*R22*R32),                                 l12*(2*R31^2 + 2*R32^2), 0, 0,  0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                   0,                                    0,                                 0, 0, 0,  0,                                              0,                                                0,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,     0,     0,     0, -R33, 2*R32*(r1_y + r_b/2) + 2*R31*(r1_x + (3^(1/2)*r_b)/2), 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                 2*R31*l12*(a11_x - q_x),                                                                                                 2*R32*l12*(a11_x - q_x),                                                                                                                       0,                                                                                               2*R31*l12*(a11_y - q_y),                                                                                               2*R32*l12*(a11_y - q_y),                                                                                                                     0,                                                                        l12*(2*r1_x + 3^(1/2)*r_b + 2*R31*(a11_z - q_z)),                                                                                l12*(2*r1_y + r_b + 2*R32*(a11_z - q_z)),                                                                                                                    -l11,                          -l12*(2*R11*R31 + 2*R12*R32),                          -l12*(2*R21*R31 + 2*R22*R32),                              -l12*(2*R31^2 + 2*R32^2)
                            0,             0,  0,                                            0,                                            0,                                            0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                                      -1,                                                       0,                                                       0, 1, 0,  0,                                   0,                                    0,                                 0, 0, 0,  0,                                              0,                                                0,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,     0,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                     0,                                                     0,                                                     0
                            0,             0,  0,                                            0,                                            0,                                            0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                                       0,                                                      -1,                                                       0, 0, 1,  0,                                   0,                                    0,                                 0, 0, 0,  0,                                              0,                                                0,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,     0,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                     0,                                                     0,                                                     0
                            0,             0,  0,                                            0,                                            0,                                            0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                                       0,                                                       0,                                                      -1, 0, 0,  1,                                   0,                                    0,                                 0, 0, 0,  0,                                              0,                                                0,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,     0,     0,     0,    0,                                                     0, 0,    0,                                                     0, 1,    0,                               0, 0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                     0,                                                     0,                                                     0
                            0,             0,  0,                                            0,                                            0,                                            0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                 l22*(2*R11^2 + 2*R12^2),                             l22*(2*R11*R21 + 2*R12*R22),                             l22*(2*R11*R31 + 2*R12*R32), 0, 0,  0,                                   0,                                    0,                                 0, 0, 0,  0,                                              0,                                                0,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,     0,     0,     0,    0,                                                     0, 0, -R13, 2*R12*(r2_y + r_b/2) + 2*R11*(r2_x - (3^(1/2)*r_b)/2), 0,    0,                               0, 0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                                                                        l22*(2*r2_x - 3^(1/2)*r_b + 2*R11*(a21_x - q_x)),                                                                                l22*(2*r2_y + r_b + 2*R12*(a21_x - q_x)),                                                                                                                    -l21,                                                                                               2*R11*l22*(a21_y - q_y),                                                                                               2*R12*l22*(a21_y - q_y),                                                                                                                     0,                                                                                                 2*R11*l22*(a21_z - q_z),                                                                                                 2*R12*l22*(a21_z - q_z),                                                                                                                       0,                              -l22*(2*R11^2 + 2*R12^2),                          -l22*(2*R11*R21 + 2*R12*R22),                          -l22*(2*R11*R31 + 2*R12*R32)
                            0,             0,  0,                                            0,                                            0,                                            0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                             l22*(2*R11*R21 + 2*R12*R22),                                 l22*(2*R21^2 + 2*R22^2),                             l22*(2*R21*R31 + 2*R22*R32), 0, 0,  0,                                   0,                                    0,                                 0, 0, 0,  0,                                              0,                                                0,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,     0,     0,     0,    0,                                                     0, 0, -R23, 2*R22*(r2_y + r_b/2) + 2*R21*(r2_x - (3^(1/2)*r_b)/2), 0,    0,                               0, 0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                 2*R21*l22*(a21_x - q_x),                                                                                                 2*R22*l22*(a21_x - q_x),                                                                                                                       0,                                                                      l22*(2*r2_x - 3^(1/2)*r_b + 2*R21*(a21_y - q_y)),                                                                              l22*(2*r2_y + r_b + 2*R22*(a21_y - q_y)),                                                                                                                  -l21,                                                                                                 2*R21*l22*(a21_z - q_z),                                                                                                 2*R22*l22*(a21_z - q_z),                                                                                                                       0,                          -l22*(2*R11*R21 + 2*R12*R22),                              -l22*(2*R21^2 + 2*R22^2),                          -l22*(2*R21*R31 + 2*R22*R32)
                            0,             0,  0,                                            0,                                            0,                                            0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                             l22*(2*R11*R31 + 2*R12*R32),                             l22*(2*R21*R31 + 2*R22*R32),                                 l22*(2*R31^2 + 2*R32^2), 0, 0,  0,                                   0,                                    0,                                 0, 0, 0,  0,                                              0,                                                0,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,     0,     0,     0,    0,                                                     0, 0, -R33, 2*R32*(r2_y + r_b/2) + 2*R31*(r2_x - (3^(1/2)*r_b)/2), 0,    0,                               0, 0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                 2*R31*l22*(a21_x - q_x),                                                                                                 2*R32*l22*(a21_x - q_x),                                                                                                                       0,                                                                                               2*R31*l22*(a21_y - q_y),                                                                                               2*R32*l22*(a21_y - q_y),                                                                                                                     0,                                                                        l22*(2*r2_x - 3^(1/2)*r_b + 2*R31*(a21_z - q_z)),                                                                                l22*(2*r2_y + r_b + 2*R32*(a21_z - q_z)),                                                                                                                    -l21,                          -l22*(2*R11*R31 + 2*R12*R32),                          -l22*(2*R21*R31 + 2*R22*R32),                              -l22*(2*R31^2 + 2*R32^2)
                            0,             0,  0,                                            0,                                            0,                                            0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                  -1,                                    0,                                 0, 1, 0,  0,                                              0,                                                0,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,     0,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                     0,                                                     0,                                                     0
                            0,             0,  0,                                            0,                                            0,                                            0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                   0,                                   -1,                                 0, 0, 1,  0,                                              0,                                                0,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,     0,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                     0,                                                     0,                                                     0
                            0,             0,  0,                                            0,                                            0,                                            0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                   0,                                    0,                                -1, 0, 0,  1,                                              0,                                                0,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,     0,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 1,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                     0,                                                     0,                                                     0
                            0,             0,  0,                                            0,                                            0,                                            0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                                       0,                                                       0,                                                       0, 0, 0,  0,             l32*(2*R11^2 + 2*R12^2),          l32*(2*R11*R21 + 2*R12*R22),       l32*(2*R11*R31 + 2*R12*R32), 0, 0,  0,                                              0,                                                0,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,     0,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0, -R13, 2*R11*r3_x + 2*R12*(r3_y - r_b), 0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                                                                                      l32*(2*r3_x + 2*R11*(a31_x - q_x)),                                                                              l32*(2*r3_y - 2*r_b + 2*R12*(a31_x - q_x)),                                                                                                                    -l31,                                                                                               2*R11*l32*(a31_y - q_y),                                                                                               2*R12*l32*(a31_y - q_y),                                                                                                                     0,                                                                                                 2*R11*l32*(a31_z - q_z),                                                                                                 2*R12*l32*(a31_z - q_z),                                                                                                                       0,                              -l32*(2*R11^2 + 2*R12^2),                          -l32*(2*R11*R21 + 2*R12*R22),                          -l32*(2*R11*R31 + 2*R12*R32)
                            0,             0,  0,                                            0,                                            0,                                            0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                                       0,                                                       0,                                                       0, 0, 0,  0,         l32*(2*R11*R21 + 2*R12*R22),              l32*(2*R21^2 + 2*R22^2),       l32*(2*R21*R31 + 2*R22*R32), 0, 0,  0,                                              0,                                                0,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,     0,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0, -R23, 2*R21*r3_x + 2*R22*(r3_y - r_b), 0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                 2*R21*l32*(a31_x - q_x),                                                                                                 2*R22*l32*(a31_x - q_x),                                                                                                                       0,                                                                                    l32*(2*r3_x + 2*R21*(a31_y - q_y)),                                                                            l32*(2*r3_y - 2*r_b + 2*R22*(a31_y - q_y)),                                                                                                                  -l31,                                                                                                 2*R21*l32*(a31_z - q_z),                                                                                                 2*R22*l32*(a31_z - q_z),                                                                                                                       0,                          -l32*(2*R11*R21 + 2*R12*R22),                              -l32*(2*R21^2 + 2*R22^2),                          -l32*(2*R21*R31 + 2*R22*R32)
                            0,             0,  0,                                            0,                                            0,                                            0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                                       0,                                                       0,                                                       0, 0, 0,  0,         l32*(2*R11*R31 + 2*R12*R32),          l32*(2*R21*R31 + 2*R22*R32),           l32*(2*R31^2 + 2*R32^2), 0, 0,  0,                                              0,                                                0,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,     0,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0, -R33, 2*R31*r3_x + 2*R32*(r3_y - r_b), 0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                 2*R31*l32*(a31_x - q_x),                                                                                                 2*R32*l32*(a31_x - q_x),                                                                                                                       0,                                                                                               2*R31*l32*(a31_y - q_y),                                                                                               2*R32*l32*(a31_y - q_y),                                                                                                                     0,                                                                                      l32*(2*r3_x + 2*R31*(a31_z - q_z)),                                                                              l32*(2*r3_y - 2*r_b + 2*R32*(a31_z - q_z)),                                                                                                                    -l31,                          -l32*(2*R11*R31 + 2*R12*R32),                          -l32*(2*R21*R31 + 2*R22*R32),                              -l32*(2*R31^2 + 2*R32^2)
                            0,             0,  0,                                            0,                                            0,                                            0,                     (2*p1_o*p_rE1*(p1_n/p_n - 1))/e_r^2,                    -(2*p1_t*p_rE1*(p1_n/p_n - 1))/e_r^2,                                                       0, 0, 0,  0,                         (2*p1_o*p2_n*p_rE1)/(e_r^2*p_n),                        -(2*p2_n*p1_t*p_rE1)/(e_r^2*p_n),                                                       0, 0, 0,  0,     (2*p1_o*p3_n*p_rE1)/(e_r^2*p_n),     -(2*p3_n*p1_t*p_rE1)/(e_r^2*p_n),                                 0, 0, 0,  0, (2*p_rE1*(a11_y - a_y))/e_r^2 - (2*p1_t)/e_t^2, - (2*p1_o)/e_o^2 - (2*p_rE1*(a11_x - a_x))/e_r^2, -(2*p_rE1)/e_r^2,                                              0,                                                0,                0,                                              0,                                                0,                0,     0,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                    (2*(p1_n*p_n*e_r^2*mu^2 + a11_x*p1_o*p_rE1 - a11_y*p1_t*p_rE1 - a_x*p1_o*p_rE1 + a_y*p1_t*p_rE1))/(e_r^2*p_n),                                                                            (2*p_rE1*(a21_x*p1_o - a21_y*p1_t - a_x*p1_o + a_y*p1_t))/(e_r^2*p_n),                                                                            (2*p_rE1*(a31_x*p1_o - a31_y*p1_t - a_x*p1_o + a_y*p1_t))/(e_r^2*p_n),                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                     0,                                                     0,                                                     0
                            0,             0,  0,                                            0,                                            0,                                            0,                         (2*p1_n*p2_o*p_rE2)/(e_r^2*p_n),                        -(2*p1_n*p2_t*p_rE2)/(e_r^2*p_n),                                                       0, 0, 0,  0,                     (2*p2_o*p_rE2*(p2_n/p_n - 1))/e_r^2,                    -(2*p2_t*p_rE2*(p2_n/p_n - 1))/e_r^2,                                                       0, 0, 0,  0,     (2*p2_o*p3_n*p_rE2)/(e_r^2*p_n),     -(2*p3_n*p2_t*p_rE2)/(e_r^2*p_n),                                 0, 0, 0,  0,                                              0,                                                0,                0, (2*p_rE2*(a21_y - a_y))/e_r^2 - (2*p2_t)/e_t^2, - (2*p2_o)/e_o^2 - (2*p_rE2*(a21_x - a_x))/e_r^2, -(2*p_rE2)/e_r^2,                                              0,                                                0,                0,     0,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                                            (2*p_rE2*(a11_x*p2_o - a11_y*p2_t - a_x*p2_o + a_y*p2_t))/(e_r^2*p_n),                                    (2*(p2_n*p_n*e_r^2*mu^2 + a21_x*p2_o*p_rE2 - a21_y*p2_t*p_rE2 - a_x*p2_o*p_rE2 + a_y*p2_t*p_rE2))/(e_r^2*p_n),                                                                            (2*p_rE2*(a31_x*p2_o - a31_y*p2_t - a_x*p2_o + a_y*p2_t))/(e_r^2*p_n),                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                     0,                                                     0,                                                     0
                            0,             0,  0,                                            0,                                            0,                                            0,                         (2*p1_n*p3_o*p_rE3)/(e_r^2*p_n),                        -(2*p1_n*p3_t*p_rE3)/(e_r^2*p_n),                                                       0, 0, 0,  0,                         (2*p2_n*p3_o*p_rE3)/(e_r^2*p_n),                        -(2*p2_n*p3_t*p_rE3)/(e_r^2*p_n),                                                       0, 0, 0,  0, (2*p3_o*p_rE3*(p3_n/p_n - 1))/e_r^2, -(2*p3_t*p_rE3*(p3_n/p_n - 1))/e_r^2,                                 0, 0, 0,  0,                                              0,                                                0,                0,                                              0,                                                0,                0, (2*p_rE3*(a31_y - a_y))/e_r^2 - (2*p3_t)/e_t^2, - (2*p3_o)/e_o^2 - (2*p_rE3*(a31_x - a_x))/e_r^2, -(2*p_rE3)/e_r^2,     0,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                                            (2*p_rE3*(a11_x*p3_o - a11_y*p3_t - a_x*p3_o + a_y*p3_t))/(e_r^2*p_n),                                                                            (2*p_rE3*(a21_x*p3_o - a21_y*p3_t - a_x*p3_o + a_y*p3_t))/(e_r^2*p_n),                                    (2*(p3_n*p_n*e_r^2*mu^2 + a31_x*p3_o*p_rE3 - a31_y*p3_t*p_rE3 - a_x*p3_o*p_rE3 + a_y*p3_t*p_rE3))/(e_r^2*p_n),                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                     0,                                                     0,                                                     0
                            0,             0,  0,                                            0,                                            0,                                            0,                                                     R13,                                                     R23,                                                     R33, 0, 0,  0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                   0,                                    0,                                 0, 0, 0,  0,                                              0,                                                0,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,     0,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                       0,                                                                                                                       0,                                                                                                             a11_x - q_x,                                                                                                                     0,                                                                                                                     0,                                                                                                           a11_y - q_y,                                                                                                                       0,                                                                                                                       0,                                                                                                             a11_z - q_z,                                                  -R13,                                                  -R23,                                                  -R33
                            0,             0,  0,                                            0,                                            0,                                            0, - 2*R12*(r1_y + r_b/2) - 2*R11*(r1_x + (3^(1/2)*r_b)/2), - 2*R22*(r1_y + r_b/2) - 2*R21*(r1_x + (3^(1/2)*r_b)/2), - 2*R32*(r1_y + r_b/2) - 2*R31*(r1_x + (3^(1/2)*r_b)/2), 0, 0,  0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                   0,                                    0,                                 0, 0, 0,  0,                                              0,                                                0,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,     0,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                                                                               -2*(r1_x + (3^(1/2)*r_b)/2)*(a11_x - q_x),                                                                                         -2*(a11_x - q_x)*(r1_y + r_b/2),                                                                                                                       0,                                                                             -2*(r1_x + (3^(1/2)*r_b)/2)*(a11_y - q_y),                                                                                       -2*(a11_y - q_y)*(r1_y + r_b/2),                                                                                                                     0,                                                                               -2*(r1_x + (3^(1/2)*r_b)/2)*(a11_z - q_z),                                                                                         -2*(a11_z - q_z)*(r1_y + r_b/2),                                                                                                                       0, 2*R12*(r1_y + r_b/2) + 2*R11*(r1_x + (3^(1/2)*r_b)/2), 2*R22*(r1_y + r_b/2) + 2*R21*(r1_x + (3^(1/2)*r_b)/2), 2*R32*(r1_y + r_b/2) + 2*R31*(r1_x + (3^(1/2)*r_b)/2)
                            0,             0,  0,                                            0,                                            0,                                            0,                                                       0,                                                       0,                                                       0, 0, 0, -1,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                   0,                                    0,                                 0, 0, 0,  0,                                              0,                                                0,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,     0,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                     0,                                                     0,                                                     0
                            0,             0,  0,                                            0,                                            0,                                            0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                                     R13,                                                     R23,                                                     R33, 0, 0,  0,                                   0,                                    0,                                 0, 0, 0,  0,                                              0,                                                0,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,     0,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                       0,                                                                                                                       0,                                                                                                             a21_x - q_x,                                                                                                                     0,                                                                                                                     0,                                                                                                           a21_y - q_y,                                                                                                                       0,                                                                                                                       0,                                                                                                             a21_z - q_z,                                                  -R13,                                                  -R23,                                                  -R33
                            0,             0,  0,                                            0,                                            0,                                            0,                                                       0,                                                       0,                                                       0, 0, 0,  0, - 2*R12*(r2_y + r_b/2) - 2*R11*(r2_x - (3^(1/2)*r_b)/2), - 2*R22*(r2_y + r_b/2) - 2*R21*(r2_x - (3^(1/2)*r_b)/2), - 2*R32*(r2_y + r_b/2) - 2*R31*(r2_x - (3^(1/2)*r_b)/2), 0, 0,  0,                                   0,                                    0,                                 0, 0, 0,  0,                                              0,                                                0,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,     0,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                                                                               -2*(r2_x - (3^(1/2)*r_b)/2)*(a21_x - q_x),                                                                                         -2*(a21_x - q_x)*(r2_y + r_b/2),                                                                                                                       0,                                                                             -2*(r2_x - (3^(1/2)*r_b)/2)*(a21_y - q_y),                                                                                       -2*(a21_y - q_y)*(r2_y + r_b/2),                                                                                                                     0,                                                                               -2*(r2_x - (3^(1/2)*r_b)/2)*(a21_z - q_z),                                                                                         -2*(a21_z - q_z)*(r2_y + r_b/2),                                                                                                                       0, 2*R12*(r2_y + r_b/2) + 2*R11*(r2_x - (3^(1/2)*r_b)/2), 2*R22*(r2_y + r_b/2) + 2*R21*(r2_x - (3^(1/2)*r_b)/2), 2*R32*(r2_y + r_b/2) + 2*R31*(r2_x - (3^(1/2)*r_b)/2)
                            0,             0,  0,                                            0,                                            0,                                            0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                                       0,                                                       0,                                                       0, 0, 0, -1,                                   0,                                    0,                                 0, 0, 0,  0,                                              0,                                                0,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,     0,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                     0,                                                     0,                                                     0
                            0,             0,  0,                                            0,                                            0,                                            0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                 R13,                                  R23,                               R33, 0, 0,  0,                                              0,                                                0,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,     0,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                       0,                                                                                                                       0,                                                                                                             a31_x - q_x,                                                                                                                     0,                                                                                                                     0,                                                                                                           a31_y - q_y,                                                                                                                       0,                                                                                                                       0,                                                                                                             a31_z - q_z,                                                  -R13,                                                  -R23,                                                  -R33
                            0,             0,  0,                                            0,                                            0,                                            0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                                       0,                                                       0,                                                       0, 0, 0,  0,   - 2*R11*r3_x - 2*R12*(r3_y - r_b),    - 2*R21*r3_x - 2*R22*(r3_y - r_b), - 2*R31*r3_x - 2*R32*(r3_y - r_b), 0, 0,  0,                                              0,                                                0,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,     0,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                   -2*r3_x*(a31_x - q_x),                                                                                           -2*(a31_x - q_x)*(r3_y - r_b),                                                                                                                       0,                                                                                                 -2*r3_x*(a31_y - q_y),                                                                                         -2*(a31_y - q_y)*(r3_y - r_b),                                                                                                                     0,                                                                                                   -2*r3_x*(a31_z - q_z),                                                                                           -2*(a31_z - q_z)*(r3_y - r_b),                                                                                                                       0,                       2*R11*r3_x + 2*R12*(r3_y - r_b),                       2*R21*r3_x + 2*R22*(r3_y - r_b),                       2*R31*r3_x + 2*R32*(r3_y - r_b)
                            0,             0,  0,                                            0,                                            0,                                            0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                   0,                                    0,                                 0, 0, 0, -1,                                              0,                                                0,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,     0,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                     0,                                                     0,                                                     0
                            0,             0,  0,                                            0,                                            0,                                            0,                                                       0,                                                       0,                                                       1, 0, 0,  0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                   0,                                    0,                                 0, 0, 0,  0,                                              0,                                                0,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,     0,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                     0,                                                     0,                                                     0
                            0,             0,  0,                                            0,                                            0,                                            0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                                       0,                                                       0,                                                       1, 0, 0,  0,                                   0,                                    0,                                 0, 0, 0,  0,                                              0,                                                0,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,     0,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                     0,                                                     0,                                                     0
                            0,             0,  0,                                            0,                                            0,                                            0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                                       0,                                                       0,                                                       0, 0, 0,  0,                                   0,                                    0,                                 1, 0, 0,  0,                                              0,                                                0,                0,                                              0,                                                0,                0,                                              0,                                                0,                0,     0,     0,     0,    0,                                                     0, 0,    0,                                                     0, 0,    0,                               0, 0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                                                0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                       0,                                                                                                                       0,                                                                                                                       0,                                                     0,                                                     0,                                                     0];

    
    J2 = zeros(60,52);
    J2(1:48,1:48) = eye(48);
    J2(49,:) = [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,  2*q0,  2*q1, -2*q2, -2*q3];
    J2(50,:) = [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2*q3,  2*q2,  2*q1, -2*q0];
    J2(51,:) = [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,  2*q2,  2*q3,  2*q0,  2*q1];
    J2(52,:) = [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,  2*q3,  2*q2,  2*q1,  2*q0];
    J2(53,:) = [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,  2*q0, -2*q1,  2*q2, -2*q3];
    J2(54,:) = [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2*q1, -2*q0,  2*q3,  2*q2];
    J2(55,:) = [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2*q2,  2*q3, -2*q0,  2*q1];
    J2(56,:) = [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,  2*q1,  2*q0,  2*q3,  2*q2];
    J2(57,:) = [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,  2*q0, -2*q1, -2*q2,  2*q3];
    J2(58,:) = [ h, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,     0,     0,     0,     0];
    J2(59,:) = [ 0, h, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,     0,     0,     0,     0];
    J2(60,:) = [ 0, 0, h, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,     0,     0,     0,     0];
    
    J3(1:48,1:48) = eye(48);
    J3(49:52,:) = [ 0, 0, 0, -(h*(q1_o*h^2*w_y^2 - q2_o*w_x*h^2*w_y + q1_o*h^2*w_z^2 - q3_o*w_x*h^2*w_z + 2*q0_o*w_x*h + 4*q1_o))/w_s, -(h*(q2_o*h^2*w_x^2 - q1_o*w_y*h^2*w_x + q2_o*h^2*w_z^2 - q3_o*w_y*h^2*w_z + 2*q0_o*w_y*h + 4*q2_o))/w_s, -(h*(q3_o*h^2*w_x^2 - q1_o*w_z*h^2*w_x + q3_o*h^2*w_y^2 - q2_o*w_z*h^2*w_y + 2*q0_o*w_z*h + 4*q3_o))/w_s, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    0, 0, 0,  (h*(q0_o*h^2*w_y^2 - q3_o*w_x*h^2*w_y + q0_o*h^2*w_z^2 + q2_o*w_x*h^2*w_z - 2*q1_o*w_x*h + 4*q0_o))/w_s,  (h*(q3_o*h^2*w_x^2 - q0_o*w_y*h^2*w_x + q3_o*h^2*w_z^2 + q2_o*w_y*h^2*w_z - 2*q1_o*w_y*h + 4*q3_o))/w_s, -(h*(q2_o*h^2*w_x^2 + q0_o*w_z*h^2*w_x + q2_o*h^2*w_y^2 + q3_o*w_z*h^2*w_y + 2*q1_o*w_z*h + 4*q2_o))/w_s, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    0, 0, 0, -(h*(q3_o*h^2*w_y^2 + q0_o*w_x*h^2*w_y + q3_o*h^2*w_z^2 + q1_o*w_x*h^2*w_z + 2*q2_o*w_x*h + 4*q3_o))/w_s,  (h*(q0_o*h^2*w_x^2 + q3_o*w_y*h^2*w_x + q0_o*h^2*w_z^2 - q1_o*w_y*h^2*w_z - 2*q2_o*w_y*h + 4*q0_o))/w_s,  (h*(q1_o*h^2*w_x^2 + q3_o*w_z*h^2*w_x + q1_o*h^2*w_y^2 - q0_o*w_z*h^2*w_y - 2*q2_o*w_z*h + 4*q1_o))/w_s, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    0, 0, 0,  (h*(q2_o*h^2*w_y^2 + q1_o*w_x*h^2*w_y + q2_o*h^2*w_z^2 - q0_o*w_x*h^2*w_z - 2*q3_o*w_x*h + 4*q2_o))/w_s, -(h*(q1_o*h^2*w_x^2 + q2_o*w_y*h^2*w_x + q1_o*h^2*w_z^2 + q0_o*w_y*h^2*w_z + 2*q3_o*w_y*h + 4*q1_o))/w_s,  (h*(q0_o*h^2*w_x^2 - q2_o*w_z*h^2*w_x + q0_o*h^2*w_y^2 + q1_o*w_z*h^2*w_y - 2*q3_o*w_z*h + 4*q0_o))/w_s, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
    
    J = J1*J2*J3;
    J = sparse(J);
end
end
